<!DOCTYPE HTML>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
<script src="../generativeText.js"></script>
<script src="GTFormGUI.js"></script>
<script src="GTProcessGUI.js"></script>

<!-- Bootstrap -->
<link rel="stylesheet" href="http://netdna.bootstrapcdn.com/bootstrap/3.1.1/css/bootstrap.min.css">
<link rel="stylesheet" href="http://netdna.bootstrapcdn.com/bootstrap/3.1.1/css/bootstrap-theme.min.css">
<script src="http://netdna.bootstrapcdn.com/bootstrap/3.1.1/js/bootstrap.min.js"></script>

<style type="text/css">
#text-placeholder {
	background-color: #FAFAFA;
    border-color: #E5E5E5 #EEEEEE #EEEEEE;
    border-style: solid;
    border-width: 1px 0;
    box-shadow: 0 3px 6px rgba(0, 0, 0, 0.05) inset;
    margin: 0 -15px 15px;
    padding: 45px 15px 15px;
    position: relative;
}
#text-placeholder:after {
	content: "Results";
	color: #BBBBBB;
	font-size: 12px;
	font-weight: 700;
	left: 15px;
	letter-spacing: 1px;
	position: absolute;
	text-transform: uppercase;
	top: 15px;
}

#tabs {
	padding-top: 1em;
}

#buttons {
	padding-top: 3em;
}
</style>
<script type="text/javascript">
	var guiApply = function() {
		//Change Text
		var textContainer = jQuery("#text");
		var text = jQuery("#input-text").val();
		textContainer.text( text );

		//Apply CSS to container
		var containerCss = jQuery("#input-container-css").val();
		jQuery("#text").css(  generateCssObj(containerCss)  );

		//Do Logic
		//process params
		var params = GTProcessGUI.processParams();
		//Transform params into text
		var paramsStr = stringify(params, 0);
		//process opts
		var opts = GTProcessGUI.processOpts();
		//Transform opts into text
		var optsStr = stringify(opts, 0);
		//Change code panel
		var codeStr = "var params = " + paramsStr + ";\n";
		codeStr += "var opts = " + optsStr + ";\n";
		jQuery("#code").text( codeStr );
		//Apply function to text
		generativeText.applyToElem(jQuery("#text"), params, opts);
		//Apply CSS to spans
		var spanCss = jQuery("#input-span-css").val();
		if(!!spanCss && spanCss != "") jQuery("#text span").css( generateCssObj(spanCss )  );
	}

	var generateCssObj = function(css) {
	    css = css.trim();
	    var arr = css.split(";");
	    var j = {};
	    for(var i=0; i<arr.length-1; i++) {
	        var d = arr[i].split(":");
	        j[d[0].trim()] = d[1].trim();
	    }
	    return j;
	    
	}

	var stringify = function( o, tabs ) {
		var str = "{ \n";
	    var stra = [];

	    var addTabs = function(t) {
	    	var tbs = "";
	    	t = t+1;
	    	for(var j=0; j<t; j++) {
	    		tbs += "\t";
	    	}
	    	return tbs;
	    };

		for(var i in o) {
	        var type = typeof o[i];
	        console.log(i);
			switch(type) {
				case 'string': 
					stra.push(addTabs(tabs) + i + ":'" + o[i] + "'"); 
				break;
				case 'boolean': 
				case 'number': 
				case 'function': 
					stra.push(addTabs(tabs) + i + ":" + o[i]); 
				break;
				case 'object': 
					if(Array.isArray(o[i])) {
	                    stra.push(addTabs(tabs) + i + ": ['" + o[i].join("','") + "']"); 
	                } else {
	                    stra.push(addTabs(tabs) + i + ": " + stringify(o[i], tabs+1));
	                }      
	            break;
			}
	    }
	    str += stra.join(",\n") + "\n"  + addTabs(tabs-1) + " }";
	    return str;
	}

	jQuery(document).ready(
		function() {
			jQuery("#btn-apply").click( guiApply );
			GTFormGUI.populateAddParams();
			jQuery("#btn-add-param").click( GTFormGUI.addParamFields );
			GTFormGUI.addOptsTextFields();
			jQuery('#opts-applyTo').change( GTFormGUI.applyToChange );
		}
	);
</script>

</head>
<body>
<div class="container">
	<h1>generativeText GUI</h1>
	<div class="bs-example">
		<div id="text-placeholder">
			<div id="text">
				Lorem Ipsum donor.
			</div>
		</div>
	</div>
	<div class="form-container">
		<ul class="nav nav-tabs">
			<li class="active"><a href="#text-tab" data-toggle="tab">Text</a></li>
			<li><a href="#params-tab" data-toggle="tab">Params</a></li>
			<li><a href="#options-tab" data-toggle="tab">Options</a></li>
			<li><a href="#code-tab" data-toggle="tab">Code</a></li>
		</ul>

<form class="form-horizontal" role="form">
	<div class="form-group">

		<div class="tab-content" id="tabs">
			<div class="tab-pane active" id="text-tab">
				<div class="form-group">
					<label for="input-text" class="col-sm-1 control-label">Text</label>
					<div class="col-sm-11">
						<textarea class="form-control" id="input-text"></textarea>
					</div>
				</div>
				<div class="form-group">
					<label for="input-container-css" class="col-sm-1 control-label">Predefined Div Css</br>(Container element)</label>
					<div class="col-sm-11">
						<textarea class="form-control" id="input-container-css"></textarea>
					</div>
				</div>
				<div class="form-group">
					<label for="input-span-css" class="col-sm-1 control-label">Predefined Span Css</label>
					<div class="col-sm-11">
						<textarea class="form-control" id="input-span-css"></textarea>
					</div>
				</div>
			</div>
			<div class="tab-pane" id="params-tab">

				<div class="form-group">
					<label for="select-param-name" class="control-label col-sm-2">Select parameter type</label>
					<div class="col-sm-8">
						<select class="form-control" id="select-param-name"></select>
					</div>
					<button type="button" class="btn btn-primary  col-sm-2" id="btn-add-param">
						<span class="glyphicon glyphicon-plus"></span> Add
					</button>
				</div>

	 		</div>

			<div class="tab-pane" id="options-tab">

				<div class="form-group">
					<label for="opts-applyTo" class="control-label col-sm-2">Apply to</label>
					<div class="col-sm-10">
						<select class="form-control" id="opts-applyTo">
							<option value="text">Text</text>
							<option value="words">Words</text>
						</select>

					</div>
				</div>
			</div>

			<div class="tab-pane" id="code-tab">
				<pre><code id="code">
				</code></pre>
			</div>
		</div>

	</div>
</form>

		<div class="buttons" id="buttons">
			<button type="button" class="btn btn-default" id="btn-apply">
				Apply <span class="glyphicon glyphicon-ok"></span>
			</button>
		</div>
	</div>
	<hr/>
	<footer>
		<p>&copy; Company 2014</p>
	</footer>
</div>
</body>
</html>

